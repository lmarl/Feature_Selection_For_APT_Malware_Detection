############################
# Este script obtiene usando la API Key de Virustotal la informacion que se desea (general, behaviour_summary,
# contacted_domains, behaviours, contacted_ips, contacted_urls) del MD5 que se le pasa como parÃ¡metro.
# Lo saca por salida estandar, asi que se tiene que llamar desde otro scipt
############################

#!/bin/bash

#API KEY martin.liras@gmail.com --> 7b6f7c1212bb962c6ad1a3f6e59207f860fec4baff9a522aec12b17658b2ed6a
#API KEY luis.basura@gmail.com --> 893c8e936969338aecc205a66096b31853c74cf37e24f95ffd341ebfd53090b4
#API KEY lmarl@unileon.es --> 40b966f0c0b49a10b82367bebfaf2ba6c4a088831b888b62413fe50365c19f2d
#API KEY lmartin@hp.com --> 79e972e25d8be0162f0329be0c7a975fc710b6870b0646d3c6097221ebfa652c
#API KEY luis.martin.liras@hp.com --> 0efde1a0071b51ae37208cb5b8a421693f1a2f609bfd2f95f230e73e41fd6c73

MD5=$1

#martin.liras@gmail.com:
#APIKEY="7b6f7c1212bb962c6ad1a3f6e59207f860fec4baff9a522aec12b17658b2ed6a"

#luis.martin.liras@hp.com
#APIKEY="0efde1a0071b51ae37208cb5b8a421693f1a2f609bfd2f95f230e73e41fd6c73"

#luis.basura@gmail.com
#APIKEY="893c8e936969338aecc205a66096b31853c74cf37e24f95ffd341ebfd53090b4"

#lmarl@unileon.es
#APIKEY="40b966f0c0b49a10b82367bebfaf2ba6c4a088831b888b62413fe50365c19f2d"

#lmartin@hp.com
#APIKEY="79e972e25d8be0162f0329be0c7a975fc710b6870b0646d3c6097221ebfa652c"

#luis.martin.liras@hp.com
APIKEY="0efde1a0071b51ae37208cb5b8a421693f1a2f609bfd2f95f230e73e41fd6c73"

echo '{"FILE_SUMMARY":'
curl --request GET   --url https://www.virustotal.com/api/v3/files/{$MD5}  --header 'x-apikey: '$APIKEY

echo ',"BEHAVIOUR_SUMMARY":'
curl --request GET  --url https://www.virustotal.com/api/v3/files/{$MD5}/behaviour_summary  --header 'x-apikey: '$APIKEY

#echo ',"CONTACTED_DOMAINS":'
#curl --request GET --url https://www.virustotal.com/api/v3/files/{$MD5}/contacted_domains --header 'x-apikey: '$APIKEY

#echo ',"BEHAVIOURS":'
#curl --request GET --url https://www.virustotal.com/api/v3/files/{$MD5}/behaviours --header 'x-apikey: '$APIKEY

#echo ',"CONTACTED_IPS":'
#curl --request GET --url https://www.virustotal.com/api/v3/files/{$MD5}/contacted_ips --header 'x-apikey: '$APIKEY

#echo ',"CONTACTED_URLS":'
#curl --request GET --url https://www.virustotal.com/api/v3/files/{$MD5}/contacted_urls --header 'x-apikey: '$APIKEY
echo '}'
