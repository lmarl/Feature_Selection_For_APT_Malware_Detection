########################################################
# Este script coge los directorios de nuevos APTs, Crea los subdirectorios peframe y reports, obtiene su MD5
#y obtiene los anÃ¡lisis dinamico (mediante curl.sh) y estattico (mediante peframe)
##########################################

#!/bin/bash

#ESTADO:
# - Todos los peframe obtenidos
# - Todos los reports obtenidos


for i in OlympicDestroyer DPRK GamaredonGroup GreenbugAPT Dridex GandCrab  GreyEnergyAPT APT34,Iranian DarkHydrus DustSquad GazaAPTGroup 
VoodooBearAPT APT37,NK,Reaper  DarkTequila APTC23 GoziGroup APT19 APT10 APT32 GorgonGroup
do
	mkdir $i/peframe
	mkdir $i/reports
	for j in `ls $i`
	do
		md5=`md5sum $i/$j | awk '{ print $1 }'`

		#Obtain analisis from virustotal
		./0_curl.sh $md5  | sed 's/: null/: \"null\"/g' > $i/reports/$md5.report

		#Static analysis with peframe
		peframe $i/$j > $i/peframe/$md5.peframe
	done
done
