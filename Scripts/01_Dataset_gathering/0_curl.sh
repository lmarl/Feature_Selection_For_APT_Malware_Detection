############################
# Este script obtiene usando la API Key de Virustotal la informacion que se desea (general, behaviour_summary,
# contacted_domains, behaviours, contacted_ips, contacted_urls) del MD5 que se le pasa como parÃ¡metro.
# Lo saca por salida estandar, asi que se tiene que llamar desde otro scipt
############################

#!/bin/bash

#API KEY martin.liras@gmail.com --> 7b6f7c1212bb962c6ad1a3f6e59207f860fec4baff9a522aec12b17658b2ed6a
#API KEY luis.basura@gmail.com --> 893c8e936969338aecc205a66096b31853c74cf37e24f95ffd341ebfd53090b4
#API KEY lmarl@unileon.es --> 40b966f0c0b49a10b82367bebfaf2ba6c4a088831b888b62413fe50365c19f2d
#API KEY lmartin@hp.com --> 79e972e25d8be0162f0329be0c7a975fc710b6870b0646d3c6097221ebfa652c
#API KEY luis.martin.liras@hp.com --> 0efde1a0071b51ae37208cb5b8a421693f1a2f609bfd2f95f230e73e41fd6c73

MD5=$1

if [ $2 -eq 1 ];then
#martin.liras@gmail.com:  Incorrect21.
  APIKEY="7b6f7c1212bb962c6ad1a3f6e59207f860fec4baff9a522aec12b17658b2ed6a"
fi

if [ $2 -eq 2 ];then
#martin.liras@gmx.es Sarilm1.
  APIKEY="2859b1e5a964aaf820cb41b00bfdbad7f40f1067d09aff8f72dabb70570bd052"
fi

if [ $2 -eq 3 ];then
#luis.basura@gmail.com  Sarilm1.
  APIKEY="893c8e936969338aecc205a66096b31853c74cf37e24f95ffd341ebfd53090b4"
fi

if [ $2 -eq 4 ];then
#lmarl@unileon.es  10V3craf
  APIKEY="40b966f0c0b49a10b82367bebfaf2ba6c4a088831b888b62413fe50365c19f2d"
fi

if [ $2 -eq 5 ];then
#lmartin@hp.com   hot.can-41
  APIKEY="79e972e25d8be0162f0329be0c7a975fc710b6870b0646d3c6097221ebfa652c"
fi

if [ $2 -eq 6 ];then
#jaimemartingutierrez19@maristasleon.net
  APIKEY="445373fab471ef90dbac03eb40a5b36db091d20f49f39fb2e04c519dd1484b2a"
fi

if [ $2 -eq 7 ];then
#martin.liras@me.com   #https://appleid.apple.com   Sarilm1.
  APIKEY="0302726f3c1c81653e971f2714330331352814f1bd3cb0f51624a6c4c7b76a3d"
fi

if [ $2 -eq 8 ];then
#etclfm03@estudiantes.unileon.es  10V3craf	
  APIKEY="b0ecca05f77c731c560abdadec931ac12ca382d894ba60b7184d65d02483ccfe"
fi

if [ $2 -eq 9 ];then
#lmartl03@estudiantes.unileon.es   10V3craf
  APIKEY="52de728e8c06d5cbe6281984700f6eff701015d817b147e807a82b98048fd064"
fi

if [ $2 -eq 10 ];then
#bgutg@unileon.es
  APIKEY="75aca1e1854f3c76a71ff896ffae8c3ec2748afa4e29daf43a4b2c20a2a1811d"
fi

if [ $2 -eq 11 ];then
#l.martin.liras@unileon.es
  APIKEY="b86d186871a15da3fe1d5d89376764d256f20f984a733cacc9a1101110e18aac"
fi

if [ $2 -eq 12 ];then
#jf.martin@unileon.es
  APIKEY="f766a1751f58c7713b6a6f936dab3afb74c64b4c08746813286d2c41abb99a4b"
fi

if [ $2 -eq 13 ];then
#jfmarm@unileon.es
  APIKEY="a5033f1c0a74cab9bef623144c2dff678c21690257f29fde2faef95b5399ef01"
fi

if [ $2 -eq 14 ];then
#luis.martin.liras@hp.com  hot.can-41
  APIKEY="0efde1a0071b51ae37208cb5b8a421693f1a2f609bfd2f95f230e73e41fd6c73"
fi

if [ $2 -eq 15 ];then
#martin.liras@mailfence.com
  APIKEY="f1e75c014b9b68710c30d9c5748af01fc64006389284400cf5c5a982e781bd79"
fi

if [ $2 -eq 16 ];then
#mliras@gmx.es
  APIKEY="5091379fe532e5a2849eefd8d49c27b20653bad12d075b58107d9db53864716e"
fi

if [ $2 -eq 17 ];then
#luis.basura@gmx.es
  APIKEY="49618274b10e9bc343c7f44cc47f1a579027e286ca48d1cef4e5b3db6e51614a"
fi

if [ $2 -eq 18 ];then
#luis.martin.liras@gmx.es
  APIKEY="11b07698b98704a66d1dc224686eae93ce3a65a0c957401fd426bc6d1a06732b"
fi

if [ $2 -eq 19 ];then
  APIKEY="a68c6dcbe2e346a76332127f076244037c366615772b7ba27efd9b6749c9ef12"
fi

if [ $2 -eq 20 ];then
	#temp_Account1
  APIKEY="8e0525310991f690b452498288761a74c1d566ac003ea151093b5d4ea620c549"
fi
if [ $2 -eq 21 ];then
	#temp_Account3
  APIKEY="98b49496ef3261aa36b1789bad0f58385975b49d26d58f4369d87a79b373fa14"
fi
if [ $2 -eq 22 ];then
	#temp_Account3
  APIKEY="c452c1415f1d5b3bd7c3374eb134a1dd578cfc4e2a94b8dc3a328edb298fd1b3"
fi

echo '{"FILE_SUMMARY":'
curl --request GET   --url https://www.virustotal.com/api/v3/files/{$MD5}  --header 'x-apikey: '$APIKEY

echo ',"BEHAVIOUR_SUMMARY":'
curl --request GET  --url https://www.virustotal.com/api/v3/files/{$MD5}/behaviour_summary  --header 'x-apikey: '$APIKEY

#echo ',"CONTACTED_DOMAINS":'
#curl --request GET --url https://www.virustotal.com/api/v3/files/{$MD5}/contacted_domains --header 'x-apikey: '$APIKEY

#echo ',"BEHAVIOURS":'
#curl --request GET --url https://www.virustotal.com/api/v3/files/{$MD5}/behaviours --header 'x-apikey: '$APIKEY

#echo ',"CONTACTED_IPS":'
#curl --request GET --url https://www.virustotal.com/api/v3/files/{$MD5}/contacted_ips --header 'x-apikey: '$APIKEY

#echo ',"CONTACTED_URLS":'
#curl --request GET --url https://www.virustotal.com/api/v3/files/{$MD5}/contacted_urls --header 'x-apikey: '$APIKEY
echo '}'
