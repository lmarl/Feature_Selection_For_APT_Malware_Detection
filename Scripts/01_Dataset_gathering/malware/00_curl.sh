############################
# Este script obtiene usando la API Key de Virustotal la informacion que se desea (general, behaviour_summary,
# contacted_domains, behaviours, contacted_ips, contacted_urls) del MD5 que se le pasa como par√°metro.
# Lo saca por salida estandar, asi que se tiene que llamar desde otro scipt
############################

#!/bin/bash

MD5=$1
APIKEY="XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"

echo '{"FILE_SUMMARY":'
curl --request GET   --url https://www.virustotal.com/api/v3/files/{$MD5}  --header 'x-apikey: '$APIKEY

echo ',"BEHAVIOUR_SUMMARY":'
curl --request GET  --url https://www.virustotal.com/api/v3/files/{$MD5}/behaviour_summary  --header 'x-apikey: '$APIKEY

#echo ',"CONTACTED_DOMAINS":'
curl --request GET --url https://www.virustotal.com/api/v3/files/{$MD5}/contacted_domains --header 'x-apikey: '$APIKEY

#echo ',"BEHAVIOURS":'
curl --request GET --url https://www.virustotal.com/api/v3/files/{$MD5}/behaviours --header 'x-apikey: '$APIKEY

#echo ',"CONTACTED_IPS":'
curl --request GET --url https://www.virustotal.com/api/v3/files/{$MD5}/contacted_ips --header 'x-apikey: '$APIKEY

#echo ',"CONTACTED_URLS":'
curl --request GET --url https://www.virustotal.com/api/v3/files/{$MD5}/contacted_urls --header 'x-apikey: '$APIKEY

echo '}'
