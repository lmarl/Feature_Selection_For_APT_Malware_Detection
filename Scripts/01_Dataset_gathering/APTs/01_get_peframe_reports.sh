################################################################
#
#   This script obtains the static Analysis for every sample
#   previously downloaded from VirusShare. To do that it uses the 
#   peframe.py script from https://github.com/guelfoweb/peframe
#
#   Author: Luis Martin Liras
#
################################################################

for k in 016_OK 019_OK 021_OK 025_OK 028_OK 032_OK 037_OK 040_OK 056_OK 069_OK 085_OK 099_OK 122_OK 160_OK 165_OK 169_OK 170_OK 174_OK 175_OK
do
   for i in  0 1 2 3 4 5 6 7 8 9 a b c d e f
   do
	mkdir ../../VirusShare_00$k/$i/PE/peframe
	for j in `ls ../../VirusShare_00$k/$i/PE/ | grep VirusShare`
	do
		echo 00$k/$i/PE/$j
		timeout 10s python /home/luis/malware/tools/peframe-master/peframe.py ../../VirusShare_00$k/$i/PE/$j > ../../VirusShare_00$k/$i/PE/peframe/$j.peframe
	done
   done
done
