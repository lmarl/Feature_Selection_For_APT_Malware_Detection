################################################################
#
#   This script obtains the static Analysis for every sample
#   previously downloaded from VirusShare. To do that it uses the 
#   peframe.py script from https://github.com/guelfoweb/peframe
#
#   Author: Luis Martin Liras
#
################################################################

for k in 01-Duqu_OK 11-MiniDuke_OK 16-Gauss_OK 02-BlackEnergy2.1_OK 07-Duqu2_OK 12-CozyDuke_OK 03-Turla_OK 08-Skywiper-A.Flame_OK  13-APT28-Sofacy_OK
04-Regin_OK 09-APT1_OK 14-EquationGroup_OK 05-Careto_Feb2014_OK 10-CosmicDuke_OK 15-DarkSeoul-OperationTroy_OK 15-DarkSeoul-OperationTroy_OK
do
   for i in  0 1 2 3 4 5 6 7 8 9 a b c d e f
   do
	mkdir ../../$k/$i/PE/peframe
	for j in `ls ../../$k/$i/PE/ | grep VirusShare`
	do
		echo $k/$i/PE/$j
		timeout 10s python /home/luis/malware/tools/peframe-master/peframe.py ../../$k/$i/PE/$j > ../../$k/$i/PE/peframe/$j.peframe
	done
   done
done
