USE APTs;

--//ALTER TABLE CSV ADD COLUMN LANG-BINARY VARCHAR(64);

--//create temporary table tmp4 SELECT MD5, GROUP_CONCAT(lang SEPARATOR ',') functions FROM PE_Resource_Detail group by MD5;

--//alter table tmp4 add binar varchar(123);

create table new_lang_binary select MD5, concat ('', 
CASE WHEN functions LIKE '%DUTCH%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%NEUTRAL%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%GERMAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%ENGLISH US%' THEN '1' ELSE '0' END,
CASE WHEN functions LIKE '%CHINESE SIMPLIFI' THEN '1' ELSE '0' END,
CASE WHEN functions LIKE '%ENGLISH UK%' THEN '1' ELSE '0' END,
CASE WHEN functions LIKE '%RUSSIAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%ARABIC%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%LITHUANIAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%NORWEGIAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%GEORGIAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE 'CHINESE TRADITIO' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%SERBIAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%FRENCH%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%ITALIAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%JAPANESE%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%KOREAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%RHAETO%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%PORTUGUESE%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%SAAMI%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%SPANISH%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%HEBREW%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%SWEDISH%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%LATVIAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%ALBANIAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%TATAR%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%NEUTRAL DEFA%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%SLOVAK%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%MALAYALAM%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%DIVEHI%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%MACEDONIAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%ASSAMESE%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%TURKISH%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%FARSI%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%AZERI%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%FINNISH%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%GAELIC%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%CZECH%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%ROMANIAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE 'NEUTRAL SYS DEFA' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%ZULU%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%ENGLISH AUS%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%EIRE%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%BASQUE%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%BRAZI%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%URDU%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%ESTONIAN%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%INVARIANT%' THEN '1' ELSE '0' END, 
CASE WHEN functions LIKE '%INDONESIAN%' THEN '1' ELSE '0' END ) binario from tmp4;

UPDATE newCSV SET LANG-BINARY=(SELECT binar FROM new_lang_binary WHERE new_lang_binary.MD5=newCSV.MD5);
