use APTs;

ALTER TABLE CSV ADD COLUMN SERVICES_BINARY VARCHAR(219);

create table services4 select MD5, group_concat(service_name) service_name from services group by MD5;

create table services_binary select MD5, concat ('', 
CASE WHEN service_name LIKE '%NOD32Service%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%PPTVService%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%DcomLaunch%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%PowerManager%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%VisNetic_AntiVirus_Plug_in%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%RpcSs%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%svflooje%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%zonealarm%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%PlugPlay%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%NOD32ControlCenter%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%WZCSVC%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%NWCWorkstation%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%netsvcs_0x0%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%TermService%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Driver%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Symantec_AntiVirus_Client%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Norton_AntiVirus_Auto_Protect_Se%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Win32%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%WINDOWS%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%AntiVirService%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%w32time%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Symantec%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SAVScan%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ShellHWDetection%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SVCHOST%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%abp470n5%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Netman%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Nla%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%helpsvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%RemoteRegistry%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Beep%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SSDPSRV%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%NTICE%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%COMODO_Firewall_Pro_Sandbox_Driv%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%IceExt%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ekrn%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%avp1%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%tcpsr%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%asc3360pr%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%cmdGuard%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%kavsvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%cmdAgent%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Ias%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Symantec_Password_Validation%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Iprip%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%BackWeb_Plug_in___4476822%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Irmon%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SRSERVICE%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%oreans32%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SavRoam%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SPIDERNT%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Amon_monitor%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SpIDer_Guard_File_System_Monitor%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%AV_Engine%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SpIDer_FS_Monitor_for_Windows_NT%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Google_Online_Services%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Eset_HTTP_Server%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Eset_Personal_Firewall%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%bdss%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%aswTdi%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%avast!_Asynchronous_Virus_Monito%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%MSWindows%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%aswFsBlk%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%avast!_Self_Protection%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%avast!_iAVS4_Control_Service%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%acssrv%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%AVG_E_mail_Scanner%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%aswMon2%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%tmproxy%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%aswRdr%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%AsyncMac%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%aswSP%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Outpost_Firewall_main_module%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ProtoPort_Firewall_service%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%F_Prot_Antivirus_Update_Monitor%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Eset_Service%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%DHCP%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%PersonalFirewal%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%PAVFIRES%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%LanmanServer%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%WebrootDesktopFirewallDataServic%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%DMServer%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%RapApp%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%WebrootFirewall%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%PcCtlCom%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%KPF4%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%PREVSRV%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%PAVFNSVR%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%TmPfw%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%PavProt%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%LavasoftFirewall%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%PSIMSVC%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%avast!_Mail_Scanner%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%PavPrSrv%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Agnitum_Client_Security_Service%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%NSCService%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%LIVESRV%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%avast!_Web_Scanner%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%PAVSRV%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Schedule%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%VSSERV%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ISSvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%KLIF%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%avast!_Antivirus%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%BGLiveSvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%InoRT%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%CAISafe%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%InoTask%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ERSvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%XCOMM%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%6to4%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Symantec_Core_LC%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%InoRPC%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Tmntsrv%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%UmxCfg%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%fsbwsys%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%UmxLU%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%F_Secure_Gatekeeper_Handler_Star%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SPBBCSvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%UmxPol%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SNDSrvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%BlackICE%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%aswUpdSv%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ccProxy%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%NPFMntor%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%McAfeeFramework%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%McTaskManager%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%EventSystem%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%UmxAgent%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%FastUserSwitchingCompatibility%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Browser%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SmcService%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%AVP%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%outpostfirewall%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%vsmon%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ccSetMgr%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%McShield%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%LanmanWorkstation%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%FSDFWD%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ccEvtMgr%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%FSMA%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%spooler%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Kingsoft%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%WebClient%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%navapsvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%winmgmt%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%pcidump%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ALG%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Kingsoft_Antivirus_WebShield_Ser%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%NOD32krn%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%GrayPigeon_Hacker.com.cn%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%amsint32%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%NetTcpPortSharing%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%IPFILTERDRIVER%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Netlogon%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%TlntSvr%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%RSVP%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%UPS%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SCardSvr%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%NtLmSsp%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%VSS%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%stisvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%NetDDE%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Wmi%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SwPrv%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%RDSessMgr%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%NetDDEdsdm%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%RpcLocator%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%mnmsrvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%MSDTC%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%MSIServer%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%RasAuto%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SysmonLog%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%WmiApSrv%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ImapiService%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%MsMpSvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%upnphost%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%WmdmPmSN%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%xmlprov%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Ntmssvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Symantec_AntiVirus_Definition_Wa%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ac97intc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Symantec_AntiVirus%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%idsvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%FontCache3.0.0.0%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%HTTPFilter%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%TAPISRV%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%hkmsvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%EapHost%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Avira_AntiVir_Premium_MailGuard%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Avira_AntiVir_Premium_Guard%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Dot3svc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Avira_AntiVir_Premium_WebGuard%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Messenger%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%dmadmin%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%aspnet_state%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%COMSysApp%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%iphlpsvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ClipSrv%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%CiSvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%bfe%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%HidServ%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%wuauserv%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%SharedAccess%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Alerter%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%BITS%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%CryptSvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%MpsSvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%nm%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%NPF%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%NapAgent%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%AppMgmt%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%ProtectedStorage%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%WinDefend%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%wscsvc%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%Router%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%RemoteAccess%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%AudioSrv%' THEN '1' ELSE '0' END, 
CASE WHEN service_name LIKE '%RASMAN%' THEN '1' ELSE '0' END) binario from newservices4;

UPDATE newCSV SET SERVICES_BINARY=(SELECT binario FROM new_services_binary  WHERE new_services_binary.MD5=newCSV.MD5);
