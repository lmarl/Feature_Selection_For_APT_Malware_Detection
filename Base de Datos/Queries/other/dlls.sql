use APTS;

create table newimports5 select md5, group_concat(distinct DLL) DLL from imports2 where md5 in (select md5 from newCSV) group by 1;

create table new_suspicious_DLLs_binary select MD5, concat ('', CASE WHEN DLL LIKE '%KERNEL32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%USER32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%GDI32.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVBVM60.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%ADVAPI32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%Msvcrt.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%OLE32.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%COMCTL32.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%OLEAUT32.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%Shell32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MFC42.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%version.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%ws2_32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%wininet.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%WSOCK32.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%SHLWAPI.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%WINMM.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%ntoskrnl.exe%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVBVM50.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVCP60.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%comdlg32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%gdiplus.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%WINSPOOL.DRV%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MFC42u.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%ntdll.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%*invalid*%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVCR71.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVCR90.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVCR80.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%URLMON.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%rpcrt4.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%SETUPAPI.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%NETAPI32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MZ_%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%crtdll.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MFC71.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%PSAPI.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%cygwin1.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%mpr.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%crypt32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%KERNEL32%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%sal3.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%odbc32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%rtl60.bpl%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MFC80U.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%vcl60.bpl%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%Iphlpapi.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MFC80.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%atl.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%msacm32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSI.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%imm32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%oledlg.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%OPENGL32.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%mscoree.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MFC71U.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVCP71.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVCRT40.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%vcl50.bpl%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%USERENV.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVFW32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVBVM60%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%mfc90u.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVCP80.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%vclmi.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%RASAPI32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%vcl100.bpl%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVCR100.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSIMG32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%pdh.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%WLDAP32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%cxEditorsVCLD6.bpl%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%cppuhelper3MSC.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%dbghelp.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MFC70.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%cppu3.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVCIRT.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%WTSAPI32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%frx6.bpl%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%ulib.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%Common.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%AVICAP32.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%rtl100.bpl%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%user32%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%UXTHEME.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%HAL.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%imagehlp.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%QUERY.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%QtGui4.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MFC42D.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%ADSLDPC.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVCR100D.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%QtCore4.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MFC40.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSVCP90.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%WINTRUST.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%RSAENH.DLL%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%MSASN1.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%FR6.bpl%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%SECUR32.dll%' THEN '1' ELSE '0' END, CASE WHEN DLL LIKE '%%' THEN '1' ELSE '0' END ) binario from newimports5;

